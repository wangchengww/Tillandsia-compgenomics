tfas_fai$order <- order(tfas_fai$length, decreasing = T)
tlei_fai$order <- order(tlei_fai$length, decreasing = T)
all_fai <- rbind(tfas_fai, tlei_fai)
ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity")
ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100))
ggplot(all_fai,
aes(x=order, y=length, fill= species, alpha = .6)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100))
ggplot(all_fai,
aes(x=order, y=length, fill= species, alpha = .6)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_color_manual(values=c("olivedrab", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species, alpha = .6)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species, alpha = .8)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species, alpha = .9)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species, alpha = .9)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "grey40"))
ggplot(all_fai,
aes(x=order, y=length, fill= species, alpha = .9)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("ogrey40", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species, alpha = .9)) +
geom_bar(stat="identity", position = "identity") +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .6) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .2) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .9) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .9,
position_identity(reverse = T)) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "dodge", alpha = .9) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .9) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = 1) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
p3
all_fai <- rbind(tlei_fai, tfas_fai)
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = 1) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .8) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .5) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("olivedrab", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .5) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen")) +
scale_fill_discrete(name = "Species", labels = c("T. fasciculata", "T. leiboldiana"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_discrete(name = "Species", labels = c("T. fasciculata", "T. leiboldiana"))
scale_fill_manual(values=c("grey40", "darkgreen")) +
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_discrete(name = "Species", labels = c("T. fasciculata", "T. leiboldiana")) +
scale_fill_manual(values=c("grey40", "darkgreen"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_discrete(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana", ))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana", ))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(fontface = "italic"))
p3
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
p3
pdf("SuppFigure_AssemblySTats_ScaffoldSizes.pdf", width = 9, height = 7)
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
p3
dev.off()
pdf("SuppFigure_AssemblySTats_ScaffoldSizes.pdf", width = 9, height = 6)
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
p3
dev.off()
pdf("SuppFigure_AssemblySTats_ScaffoldSizes.pdf", width = 9, height = 5)
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
p3
dev.off()
pdf("SuppFigure_AssemblySTats_ScaffoldSizes.pdf", width = 9, height = 6)
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
p3
dev.off()
ortho_tfas <- read.delim("Tfas_orthology_info.per_scaffold.txt", header = F, sep = "\t")
View(ortho_tfas)
colnames(ortho_tfas) <- c('geneID', 'scaffold', 'scaffold_length', 'startpos','endpos','ogID','Acom_count', 'Tfas_count', 'Tlei_count', 'GOterms', 'Description')
# Same for Tlei
ortho_tlei <- read.delim("Tlei_orthology_info.per_scaffold.txt", header = F, sep = "\t")
colnames(ortho_tlei) <- c('geneID', 'scaffold', 'scaffold_length', 'startpos','endpos','ogID','Acom_count', 'Tfas_count', 'Tlei_count', 'GOterms', 'Description')
##
# Calculate the number of orthologous genes on each scaffold (all relations)
count_per_scaffold_Tfas <- data.frame(matrix(ncol=3))
c <- c()
for (scaffold in unique(ortho_tfas$scaffold)){
count <- (nrow(ortho_tfas[ortho_tfas$scaffold == paste0(scaffold),]))
length <- unique(ortho_tfas[ortho_tfas$scaffold == paste0(scaffold),3])
c <- c(scaffold,length, count)
count_per_scaffold_Tfas <- rbind(count_per_scaffold_Tfas,c)
colnames(count_per_scaffold_Tfas) <- c("scaffold", "length", "ortholog_count")
}
View(count_per_scaffold_Tfas)
count_per_scaffold_Tfas <- count_per_scaffold_Tfas[-1,]
# Same for Tlei
count_per_scaffold_Tlei <- data.frame(matrix(ncol=3))
c <- c()
for (scaffold in unique(ortho_tlei$scaffold)){
count <- (nrow(ortho_tlei[ortho_tlei$scaffold == paste0(scaffold),]))
length <- unique(ortho_tlei[ortho_tlei$scaffold == paste0(scaffold),3])
c <- c(scaffold,length, count)
count_per_scaffold_Tlei <- rbind(count_per_scaffold_Tlei,c)
colnames(count_per_scaffold_Tlei) <- c("scaffold", "length", "ortholog_count")
}
count_per_scaffold_Tlei <- count_per_scaffold_Tlei[-1,]
count_per_scaffold_Tlei$ortholog_count <- as.numeric(count_per_scaffold_Tlei$ortholog_count)
View(count_per_scaffold_Tlei)
##
# Select orthologues with 1:1 relation
oneone_Tfas <- ortho_tfas[(ortho_tfas$Tfas_count==1 & (ortho_tfas$Tlei_count==1)),]
# Calculate count of 1:1 orthologs per scaffold
oneone_count_per_scaffold_Tfas <- data.frame(matrix(ncol=3))
c <- c()
for (scaffold in unique(oneone_Tfas$scaffold)){
count <- (nrow(oneone_Tfas[oneone_Tfas$scaffold == paste0(scaffold),]))
length <- unique(oneone_Tfas[oneone_Tfas$scaffold == paste0(scaffold),3])
c <- c(scaffold,length, count)
oneone_count_per_scaffold_Tfas <- rbind(oneone_count_per_scaffold_Tfas,c)
colnames(oneone_count_per_scaffold_Tfas) <- c("scaffold", "length", "ortholog_count")
}
oneone_count_per_scaffold_Tfas <- oneone_count_per_scaffold_Tfas[-1,]
#Same for Tlei
oneone_Tlei <- ortho_tlei[(ortho_tlei$Tfas_count==1 & (ortho_tlei$Tlei_count==1)),]
oneone_count_per_scaffold_Tlei <- data.frame(matrix(ncol=3))
c <- c()
for (scaffold in unique(oneone_Tlei$scaffold)){
count <- (nrow(oneone_Tlei[oneone_Tlei$scaffold == paste0(scaffold),]))
length <- unique(oneone_Tlei[oneone_Tlei$scaffold == paste0(scaffold),3])
c <- c(scaffold,length, count)
oneone_count_per_scaffold_Tlei <- rbind(oneone_count_per_scaffold_Tlei,c)
colnames(oneone_count_per_scaffold_Tlei) <- c("scaffold", "length", "ortholog_count")
}
oneone_count_per_scaffold_Tlei <- oneone_count_per_scaffold_Tlei[-1,]
##
# Merge 1:1 counts with all orthologous counts and compute ratio between all counts and 1:1 counts
c2 <- merge(count_per_scaffold_Tfas, oneone_count_per_scaffold_Tfas, by = "scaffold", all = T)
c2 <- c2[,c(1:3,5)]
c2[is.na(c2)] <- 0
count_table_Tfas <- c2
colnames(count_table_Tfas) <- c("scaffold", "length", "orthocount_all", "orthocount_one")
count_table_Tfas$length <- as.numeric(count_table_Tfas$length)
count_table_Tfas$orthocount_all <- as.numeric(count_table_Tfas$orthocount_all)
count_table_Tfas$orthocount_one <- as.numeric(count_table_Tfas$orthocount_one)
count_table_Tfas$ratio <- (count_table_Tfas$orthocount_one)/(count_table_Tfas$orthocount_all)
count_table_Tfas <- count_table_Tfas[order(count_table_Tfas$length, decreasing = T),]
row.names(count_table_Tfas) <- NULL #resets row index
count_table_Tfas$order <- c(1:1155)
View(count_table_Tfas)
write.table(count_table_Tfas, "Tfas_perScaffold_Orthogenes_count.txt", index = F,
sep = "\t")
write.table(count_table_Tfas, "Tfas_perScaffold_Orthogenes_count.txt",
sep = "\t")
write.table(count_table_Tfas, "Tfas_perScaffold_Orthogenes_count.txt",
sep = "\t", quote = F, row.names = F)
# Same for Tlei
c2lei <- merge(count_per_scaffold_Tlei, oneone_count_per_scaffold_Tlei, by = "scaffold", all = T)
c2lei <- c2lei[,c(1:3,5)]
c2lei[is.na(c2lei)] <- 0
count_table_Tlei <- c2lei
colnames(count_table_Tlei) <- c("scaffold", "length", "orthocount_all", "orthocount_one")
count_table_Tlei$length <- as.numeric(count_table_Tlei$length)
count_table_Tlei$orthocount_all <- as.numeric(count_table_Tlei$orthocount_all)
count_table_Tlei$orthocount_one <- as.numeric(count_table_Tlei$orthocount_one)
count_table_Tlei$ratio <- (count_table_Tlei$orthocount_one)/(count_table_Tlei$orthocount_all)
count_table_Tlei <- count_table_Tlei[order(count_table_Tlei$length, decreasing = T),]
row.names(count_table_Tlei) <- NULL #resets row index
count_table_Tlei$order <- c(1:2210)
# Plot the number of orthologous genes per scaffold
library(ggplot2)
write.table(count_table_Tlei, "Tlei_perScaffold_Orthogenes_count.txt",
sep = "\t", quote = F, row.names = F)
count_table_Tfas <- read.delim("Tfas_perScaffold_Orthogenes_count.txt", sep = "\t",
header = T)
count_table_Tlei <- read.delim("Tlei_perScaffold_Orthogenes_count.txt", sep = "\t",
header = T)
# Plot the number of orthologous genes per scaffold
# We use tidyr to transform the dataset so that the "orthocount" columns become
# observations in the new column "type". The corresponding count is placed in a column
# called "count"
library(ggplot2)
library(tidyr)
count_table_Tfas[1:30,] %>%
gather(type, count, orthocount_all:orthocount_one) %>%
ggplot(., aes(x=order, y=count, fill=forcats::fct_rev(type))) +
geom_bar(stat="identity", position="identity") +
xlab("Scaffolds in decreasing order by size") +
ylab("Number of orthologous genes") +
labs(title = "Distribution of orthologous genes in T. fasciculata assembly") +
scale_fill_discrete(name = "Orthology", labels = c("1:1", "all"))
tfas_fai <- read.delim("tillandsia_fasciculata_assembly.sorted.fasta.fai", sep = "\t",
header = F, colClasses = c(NA, NA, "NULL", "NULL", "NULL"),
col.names = c("Scaffold", "length", "NULL", "NULL", "NULL"))
tlei_fai <- read.delim("tillandsia_leiboldiana_assembly.pilon.upper.sorted.fasta.fai", sep = "\t",
header = F, colClasses = c(NA, NA, "NULL", "NULL", "NULL"),
col.names = c("Scaffold", "length", "NULL", "NULL", "NULL"))
# Joined plot
tfas_fai$species <- 'tfas'
tfas_fai$order <- order(tfas_fai$length, decreasing = T)
tlei_fai$species <- 'tlei'
tlei_fai$order <- order(tlei_fai$length, decreasing = T)
all_fai <- rbind(tlei_fai, tfas_fai)
View(all_fai)
count_table_Tfas$species <- 'tfas'
count_table_Tlei$species <- 'tlei'
count_table_Tfas <- read.delim("Tfas_perScaffold_Orthogenes_count.txt", sep = "\t",
header = T)
count_table_Tlei <- read.delim("Tlei_perScaffold_Orthogenes_count.txt", sep = "\t",
header = T)
count_table_Tfas$species <- 'tfas'
count_table_Tlei$species <- 'tlei'
View(count_table_Tfas)
View(all_fai)
all_genes <- rbind(count_table_Tfas, count_table_Tlei)
View(all_genes)
p4 <- ggplot(all_genes,
aes(x=order, y=orthocount_all, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
p4
p4 <- ggplot(all_genes,
aes(x=order, y=orthocount_all, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Number of orthologous genes") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
p4
pdf("SuppFigure_AssemblySTats_GeneCounts_perScaff.pdf", width = 9, height = 6)
p4 <- ggplot(all_genes,
aes(x=order, y=orthocount_all, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Number of orthologous genes") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
p4
dev.off()
grid.arrange(p3, p4, nrow = 2, ncol = 1)
p3 <- ggplot(all_fai,
aes(x=order, y=length, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Scaffold length (bp)") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
grid.arrange(p3, p4, nrow = 2, ncol = 1)
all_genes <- rbind(count_table_Tlei, count_table_Tfas)
p4 <- ggplot(all_genes,
aes(x=order, y=orthocount_all, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Number of orthologous genes") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
grid.arrange(p3, p4, nrow = 2, ncol = 1)
all_genes <- rbind(count_table_Tfas, count_table_Tlei)
p4 <- ggplot(all_genes,
aes(x=order, y=orthocount_all, fill= species)) +
geom_bar(stat="identity", position = "identity", alpha = .7) +
xlim(c(0,100)) +
theme_bw() +
xlab("First 100 scaffolds by decreasing size") +
ylab("Number of orthologous genes") +
scale_fill_manual(values=c("grey40", "darkgreen"), name = "Species",
labels = c("T. fasciculata", "T. leiboldiana")) +
theme(legend.text = element_text(face = "italic"))
pdf("SuppFigure_AssemblyStats_COMBINED.pdf", width = 12, height = 6)
grid.arrange(p3, p4, nrow = 2, ncol = 1)
dev.off()
